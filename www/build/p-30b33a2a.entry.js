import{r as t,d as e,h as i,H as o}from"./p-76bbd7fc.js";import{i as n}from"./p-9327ba3c.js";import"./p-efed8a23.js";import{V as s}from"./p-627d7603.js";import{I as a}from"./p-065c0fdf.js";import"./p-d4a71799.js";let r=class{constructor(i){t(this,i),this.event_RouteTo=e(this,"event_RouteTo",7),this.isFetched_ReaderData=!1,this.no_Page=1,this.isOpen_Toc=!1,this.isOpen_Help=!1,this.isVisible_ReaderUi=!0,this.base64Str_Page="",this.scale_Embed=1,this.id_Document="",this.title_Publication="",this.edition_Publication="",this.title_Document="",this.count_Pages=0}handle_ButtonClick(t){if("action_GoBack"===t.detail.action)this.event_RouteTo.emit({type:"goBack"});else if("action_OpenToc"===t.detail.action)this.isOpen_Toc=!0;else if("action_CloseToc"===t.detail.action)this.isOpen_Toc=!1;else if("action_OpenHelp"===t.detail.action)this.isOpen_Help=!0;else if("action_CloseHelp"===t.detail.action)this.isOpen_Help=!1;else if("action_PrevPage"===t.detail.action){if(1===this.no_Page)return;this.no_Page=this.no_Page-1,this.get_Page()}else if("action_NextPage"===t.detail.action){if(this.no_Page===this.count_Pages)return;this.no_Page=this.no_Page+1,this.get_Page()}else if("action_ZoomOut"===t.detail.action){if(this.scale_Embed<=1)return;this.scale_Embed=this.scale_Embed-.15,this.el_Embed.style.transform=`scale(${this.scale_Embed})`}else if("action_ZoomIn"===t.detail.action){if(this.scale_Embed>=1.45)return;this.scale_Embed=this.scale_Embed+.15,this.el_Embed.style.transform=`scale(${this.scale_Embed})`}}handle_LinkClick(t){if("goTo_Page"===t.detail.action)this.no_Page=parseInt(t.detail.value),this.isOpen_Toc=!1,this.get_Page();else if("open_PagePrompt"===t.detail.action){let t=prompt("Enter page no","e.g. 65");if(!t)return;if(isNaN(t))return;if(this.count_Pages<parseInt(t))return;this.no_Page=parseInt(t),this.get_Page()}}handleKeyDown(t){if("ArrowLeft"===t.key){if(1===this.no_Page)return;this.no_Page=this.no_Page-1,this.get_Page()}else if("ArrowRight"===t.key){if(this.no_Page===this.count_Pages)return;this.no_Page=this.no_Page+1,this.get_Page()}else"Escape"===t.key&&(console.log("esc"),this.isVisible_ReaderUi?this.hide_ReaderUi():this.show_ReaderUi())}componentWillLoad(){this.match.params.id_Document||this.event_RouteTo.emit({type:"push",route:"/my-library",data:{}}),this.id_Document=this.match.params.id_Document.trim()}componentDidLoad(){this.get_Page()}async get_Page(){let t=(e=this.no_Page,i=a.id,{id_Document:this.id_Document.trim(),no_Page:e,id_Socket:i.trim()});var e,i;let{success:o,message:n,payload:r}=await(async t=>{let e,i=`${s.api.url}/${s.api.endpoint.reader.init}`,o={method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)};return await fetch(i,o).then((t=>t.json())).then((t=>{e=t})).catch((t=>{console.log(t)})),{success:e.success,message:e.message,payload:e.payload}})(t);o||(alert(n),this.event_RouteTo.emit({type:"push",route:"/my-library",data:{}})),this.title_Publication=r.title_Publication,this.edition_Publication=r.edition_Publication,this.title_Document=r.title_Document,this.count_Pages=r.count_Pages,this.toc=r.toc,this.base64Str_Page=r.base64Str_Page,this.isFetched_ReaderData=!0}hide_ReaderUi(){this.isOpen_Help||this.isOpen_Toc||(this.isVisible_ReaderUi=!1)}show_ReaderUi(){this.isVisible_ReaderUi=!0}render(){return i(o,null,this.isOpen_Toc||this.isOpen_Help?i("div",{class:"sub-window__background"}):"",this.isOpen_Toc&&i("div",{class:"sub-window__content"},i("header",null,i("e-button",{variant:"transparent--white",action:"action_CloseToc"}," ",i("ion-icon",{name:"close-outline"})," ")),i("main",null,i("e-text",{variant:"display",theme:"light"},"Table of Contents"),i("e-text",{theme:"light"},this.title_Publication,", ",this.edition_Publication," - ",this.title_Document),i("l-spacer",{value:2}),this.toc.length>0?i("e-list",null,this.toc.map((t=>"article"===t.type?i("e-list-item",null,i("l-row",{justifyContent:"space-between",align:"flex-start"},i("div",{class:"toc__item--1"},i("e-link",{action:"goTo_Page",event:!0,value:t.page},i("e-text",null,i("strong",null,t.title)),i("e-text",null,"Authors: ",t.author))),i("e-text",{theme:"light"},t.page))):i("div",{class:"toc__seperator"},i("e-text",{theme:"light"},t.title.toUpperCase()))))):i("e-text",{theme:"light"},"This document ",i("strong",null,"does not have")," a table of contents"))),this.isOpen_Help&&i("div",{class:"sub-window__content"},i("header",null,i("e-button",{variant:"transparent--white",action:"action_CloseHelp"}," ",i("ion-icon",{name:"close-outline"})," ")),i("main",null,i("e-text",{variant:"display",theme:"light"},"Instructions"),i("l-spacer",{value:2}),i("e-list",null,i("div",{class:"toc__seperator"},i("e-text",{theme:"light"},"PAGE NAVIGATION & ZOOM")),i("e-list-item",null,i("e-text",{theme:"light"},"Press ",i("ion-icon",{name:"arrow-forward-outline"})," arrow key for next page")),i("e-list-item",null,i("e-text",{theme:"light"},"Press ",i("ion-icon",{name:"arrow-back-outline"})," arrow key for previous page")),i("div",{class:"toc__seperator"},i("e-text",{theme:"light"},"FOCUSED READING MODE")),i("e-list-item",null,i("e-text",{theme:"light"},"Press ",i("strong",null,"ESC")," key to enter focused reading mode. It will hide the interface elements for an optimal reading experience. To exit this mode, press ESC key again."))))),i("header",{class:!this.isVisible_ReaderUi&&"hide"},i("e-button",{variant:"transparent--white",action:"action_GoBack"}," ",i("ion-icon",{name:"arrow-back-outline"})),i("l-row",null,i("e-button",{variant:"transparent--white",action:"action_OpenHelp"}," ",i("ion-icon",{name:"information-circle-outline"})," "),i("e-button",{variant:"transparent--white",action:"action_OpenToc"}," ",i("ion-icon",{name:"list-outline"})))),this.isFetched_ReaderData&&i("embed",{src:`data:application/pdf;base64,${this.base64Str_Page}#toolbar=0&navpanes=0&scrollbar=0" type="application/pdf`,ref:t=>this.el_Embed=t}),i("footer",{class:!this.isVisible_ReaderUi&&"hide"},i("div",{class:"ui-controls"},i("div",{class:"ui-controls__page-controls"},i("e-button",{variant:"transparent--white",action:"action_PrevPage",disabled:1===this.no_Page}," ",i("ion-icon",{name:"chevron-back-outline"})),"   ",i("e-link",{action:"open_PagePrompt",event:!0},this.no_Page," / ",this.count_Pages),"   ",i("e-button",{variant:"transparent--white",action:"action_NextPage",disabled:this.no_Page===this.count_Pages}," ",i("ion-icon",{name:"chevron-forward-outline"}))),i("div",{class:"ui-controls__zoom-controls"},i("e-button",{variant:"transparent--white",action:"action_ZoomOut",disabled:this.scale_Embed<=1}," ",i("ion-icon",{name:"remove-circle-outline"})," ")," ",i("e-button",{variant:"transparent--white",action:"action_ZoomIn",disabled:this.scale_Embed>=1.45}," ",i("ion-icon",{name:"add-circle-outline"})," ")))))}};n(r),r.style=":host{display:flex;justify-content:space-between;background:var(--site-bg-color);width:100%;height:100vh}header,footer{box-sizing:border-box;position:fixed;display:flex;width:100%;padding:2em;z-index:9}header{top:0;left:0;justify-content:space-between;font-size:1.3em;padding:1em}footer{bottom:0;left:0;justify-content:space-around}footer .ui-controls{display:flex;color:rgba(255, 255, 255, 0.6)}embed{width:100%;height:100vh}input{display:inline-block;margin:0;padding:0;box-sizing:border-box;background:none;outline:none;border:none;color:rgba(255, 255, 255, 0.2);font-size:1em;width:50px}.sub-window__background{position:fixed;top:0;left:0;width:100%;height:100vh;background:var(--site-bg-color);z-index:999}.sub-window__content{position:absolute;top:0;left:0;width:100%;z-index:9999;padding-bottom:8em}.sub-window__content header{position:fixed;flex-direction:row-reverse}.sub-window__content main{color:var(255, 255, 255, 0.8);width:60%;margin:0 auto;margin-top:4em;overflow:scroll}.toc__seperator{border-top:1px solid rgba(255, 255, 255, 0.1);border-bottom:1px solid rgba(255, 255, 255, 0.1);padding:1em 0}.toc__item--1{width:80%}.ui-controls__page-controls{display:flex;align-items:center;background:rgba(0, 0, 0, 0.87);padding:0.6em 1em 0.3em 1.5em;border-radius:var(--site-border-radius) 0 0 var(--site-border-radius);border-right:1px solid rgba(255, 255, 255, 0.1)}.ui-controls__zoom-controls{background:rgba(0, 0, 0, 0.87);padding:0.6em 1.5em 0.3em 1em;border-radius:0 var(--site-border-radius) var(--site-border-radius) 0}.ui-controls button{margin-top:0.25em}.hide{display:none}.title__container{width:60%;font-size:0.8em}";export{r as v_reader}